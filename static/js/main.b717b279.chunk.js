(this["webpackJsonpfrontend-broker"]=this["webpackJsonpfrontend-broker"]||[]).push([[0],{13:function(e,t,a){},14:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),c=a(7),i=a.n(c),r=(a(13),a(1)),o=a(2),l=a(4),u=a(3),p=(a(14),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,c=new Array(s),i=0;i<s;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).renderAllTopics=function(){return e.props.topicsLoaded?0===e.props.topicList.length?n.a.createElement("li",{className:"list-group-item"},"No topics found"):n.a.createElement(n.a.Fragment,null,e.props.topicList.map((function(e){return n.a.createElement("li",{className:"list-group-item",key:e},e)}))):n.a.createElement("p",{style:{color:"#FF0000"}},"Topic loading error")},e}return Object(o.a)(a,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("ul",{className:"list-group"},this.renderAllTopics()),n.a.createElement("div",{className:"pt-3",style:{textAlign:"center"}},n.a.createElement("button",{className:"btn btn-success",onClick:this.props.onUpdate},"Refresh")))}}]),a}(s.Component)),m=a(5),h=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={publisherID:-1,topicInputValue:"",topicMessage:"",selectedTopic:"",activeTopics:[]},e.handleTopicCreation=function(){e.handlePostRequest("createTopic?id="+e.state.publisherID+"&topicName="+e.state.topicInputValue)},e.handleTopicDeletion=function(){e.handlePostRequest("deleteTopic?id="+e.state.publisherID+"&topicName="+e.state.topicInputValue)},e.handlePublishMessage=function(){if(e.state.activeTopics.length>0){var t=e.state.activeTopics[0];e.state.selectedTopic.length>0&&(t=e.state.selectedTopic),e.handlePostRequest("publishMessage?id="+e.state.publisherID+"&topicName="+t+"&messageContent="+e.state.topicMessage),e.setState({topicMessage:[]})}else alert("There are no active topics at this time")},e.refreshActiveTopics=function(){fetch(e.props.apiURL+"getPublisherActiveTopics?id="+e.state.publisherID).then((function(e){return e.json()})).then((function(t){!0===t.success?e.setState({activeTopics:t.message}):alert("Error refreshing active topic list")})).catch((function(e){alert("Error refreshing active topic list")}))},e.handlePostRequest=function(t){fetch(e.props.apiURL+t,{method:"POST"}).then((function(e){return e.json()})).then((function(t){var a=t.success?"Success: ":"Failure: ";a+=t.message,alert(a),e.props.updateTopicList(),e.refreshActiveTopics()})).catch((function(e){alert("An error has occured.")}))},e.getSubscriberID=function(){fetch(e.props.apiURL+"initializePublisher").then((function(e){return e.json()})).then((function(t){!0===t.success?e.setState({publisherID:t.message}):alert("Could not initialize subscriber ID from server")})).catch((function(e){alert("Could not initialize subscriber ID from server")}))},e.destroyAllOwnedTopics=function(){fetch(e.props.apiURL+"removeAllSubscriberActiveTopics?id="+e.state.publisherID,{method:"POST"})},e.handleChange=function(t){e.setState(Object(m.a)({},t.target.name,t.target.value))},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getSubscriberID()}},{key:"componentWillUnmount",value:function(){var e=this;this.destroyAllOwnedTopics(),setTimeout((function(){return e.props.updateTopicList()}),500)}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"card container pt-3 pb-3"},n.a.createElement("div",{className:"modal-header mb-3"},n.a.createElement("h3",{className:"text-center"},"Publisher"),n.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:function(){return e.props.onDelete(e.props.id)}},n.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"form-inline"},n.a.createElement("label",{className:"pr-1"},"Topic Name "),n.a.createElement("input",{type:"text",className:"form-control mr-1",name:"topicInputValue",value:this.state.topicInputValue,onChange:this.handleChange}),n.a.createElement("button",{className:"btn btn-success mr-1",onClick:this.handleTopicCreation},"Create"),n.a.createElement("button",{className:"btn btn-danger mr-1",onClick:this.handleTopicDeletion},"Delete")),n.a.createElement("br",null),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",null,"Message Content"),n.a.createElement("textarea",{className:"form-control",name:"topicMessage",value:this.state.topicMessage,onChange:this.handleChange,rows:"3"}),n.a.createElement("form",{className:"form-inline row mt-1"},n.a.createElement("label",{className:"col-auto"},"Topic"),n.a.createElement("select",{name:"selectedTopic",value:this.state.selectedTopic,onChange:this.handleChange,className:"custom-select col-10"},this.state.activeTopics.map((function(e){return n.a.createElement("option",{key:e},e)}))),n.a.createElement("button",{className:"btn btn-success ml-1 col-1",style:{float:"right"},onClick:this.handlePublishMessage,type:"button"},"Submit")))))}}]),a}(s.Component),d=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={serverSocket:null,selectedTopic:"",subscriberID:-1,messageArea:[],subscribedArea:[]},e.connectToSocketServer=function(){var t=new WebSocket(e.props.socketURL);t.onopen=function(){console.log("Client socket connected")},t.onmessage=function(t){if(-1===e.state.subscriberID)e.setState({subscriberID:t.data}),console.log("Client socket connected with ID: "+t.data);else{e.state.messageArea.push(e.date.toLocaleTimeString()+" "+t.data),e.forceUpdate();var a=document.getElementById("messageArea");a.scrollTop=a.scrollHeight}},t.onclose=function(){console.log("Client socket disconnected.")},e.setState({serverSocket:t})},e.handleSubscribe=function(){e.state.selectedTopic.length>0?e.handlePostRequest("subscribeToTopic?id="+e.state.subscriberID+"&topicName="+e.state.selectedTopic):alert("Please select a topic")},e.handleUnsubscribe=function(){e.state.selectedTopic.length>0?e.handlePostRequest("unsubscribeToTopic?id="+e.state.subscriberID+"&topicName="+e.state.selectedTopic):alert("Please select a topic")},e.refreshActiveTopics=function(){fetch(e.props.apiURL+"getSubscriberActiveTopics?id="+e.state.subscriberID).then((function(e){return e.json()})).then((function(t){!0===t.success?e.setState({subscribedArea:t.message}):alert("Error refreshing topics")})).catch((function(e){alert("Error refreshing topics")}))},e.handlePostRequest=function(t){fetch(e.props.apiURL+t,{method:"POST"}).then((function(e){return e.json()})).then((function(t){var a=t.success?"Success: ":"Failure: ";a+=t.message,alert(a),e.refreshActiveTopics()})).catch((function(e){alert("An error has occured.")}))},e.handleChange=function(t){e.setState(Object(m.a)({},t.target.name,t.target.value))},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.connectToSocketServer(),this.date=new Date}},{key:"componentWillUnmount",value:function(){this.state.serverSocket.close()}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"card container pt-3 pb-3"},n.a.createElement("div",{className:"modal-header mb-3"},n.a.createElement("h3",{className:"text-center"},"Subscriber"),n.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:function(){return e.props.onDelete(e.props.id)}},n.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"input-group"},n.a.createElement("select",{name:"selectedTopic",value:this.state.selectedTopic,onChange:this.handleChange,onClick:this.props.updateTopicList,className:"custom-select col-10 mr-1"},n.a.createElement("option",{value:!0,hidden:!0},"Choose your topic"),this.props.topicList.map((function(e){return n.a.createElement("option",{key:e},e)}))),n.a.createElement("button",{className:"btn btn-success mr-1",onClick:this.handleSubscribe},"Subscribe"),n.a.createElement("button",{className:"btn btn-danger mr-1",onClick:this.handleUnsubscribe},"Unsubscribe")),n.a.createElement("br",null),n.a.createElement("div",{className:"form-row"},n.a.createElement("div",{className:"form-group col-10"},n.a.createElement("label",null,"Messages"),n.a.createElement("textarea",{className:"form-control",readOnly:!0,rows:"10",value:this.state.messageArea.join("\n"),id:"messageArea"})),n.a.createElement("div",{className:"form-group col-2"},n.a.createElement("label",null,"Subscribed"),n.a.createElement("textarea",{className:"form-control",readOnly:!0,rows:"10",id:"subscribedArea",value:this.state.subscribedArea.join("\n")})))))}}]),a}(s.Component),b=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={apiURL:"http://localhost:8888/",socketURL:"ws://localhost:8080/",isTopicsLoaded:!1,topicList:[],subscriberCount:1,publisherCount:2,subscriberList:[{id:0},{id:1}],publisherList:[{id:0},{id:1},{id:2}]},e.handleRetrieveActiveTopics=function(){fetch(e.state.apiURL+"getAllTopicNames").then((function(e){return e.json()})).then((function(t){!0===t.success?e.setState({isTopicsLoaded:!0,topicList:t.message}):e.setState({isTopicsLoaded:!1})})).catch((function(t){e.setState({isTopicsLoaded:!1})}))},e.handleSubscriberAdd=function(){e.state.subscriberList.push({id:e.state.subscriberCount+1}),e.setState({subscriberCount:e.state.subscriberCount+1})},e.handlePublisherAdd=function(){e.state.publisherList.push({id:e.state.publisherCount+1}),e.setState({publisherCount:e.state.publisherCount+1})},e.handlePublisherDelete=function(t){var a=e.state.publisherList.filter((function(e){return e.id!==t}));e.setState({publisherList:a})},e.handleSubscriberDelete=function(t){var a=e.state.subscriberList.filter((function(e){return e.id!==t}));e.setState({subscriberList:a})},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.handleRetrieveActiveTopics()}},{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{className:"text-center"},"Topic List"),n.a.createElement("div",{className:"pt-2 container"},n.a.createElement(p,{topicList:this.state.topicList,topicsLoaded:this.state.isTopicsLoaded,onUpdate:this.handleRetrieveActiveTopics})),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6"},n.a.createElement("button",{className:"btn btn-primary btn-block mb-2 container",onClick:this.handlePublisherAdd},"Add Publisher"),this.state.publisherList.map((function(t){return n.a.createElement(n.a.Fragment,{key:t.id},n.a.createElement(h,{apiURL:e.state.apiURL,updateTopicList:e.handleRetrieveActiveTopics,key:t.id,id:t.id,onDelete:e.handlePublisherDelete}),n.a.createElement("br",null))}))),n.a.createElement("div",{className:"col-6"},n.a.createElement("button",{className:"btn btn-primary btn-block mb-2 container",onClick:this.handleSubscriberAdd},"Add Subscriber"),this.state.subscriberList.map((function(t){return n.a.createElement(n.a.Fragment,{key:t.id},n.a.createElement(d,{className:"col-sm-6",apiURL:e.state.apiURL,socketURL:e.state.socketURL,topicList:e.state.topicList,updateTopicList:e.handleRetrieveActiveTopics,key:t.id,id:t.id,onDelete:e.handleSubscriberDelete}),n.a.createElement("br",null))})))))}}]),a}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(15);i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.b717b279.chunk.js.map